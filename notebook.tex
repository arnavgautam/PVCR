
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{PVCR}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{n}{include}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{C}\PY{l+s}{R}\PY{l+s}{.}\PY{l+s}{j}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \hypertarget{residential-cases}{%
\section{Residential cases}\label{residential-cases}}

    \hypertarget{residential-case-1-small-pv-system-this-doesnt-generate-any-injection-into-the-grid}{%
\subsection{Residential Case 1: Small PV System, this doesn't generate
any injection into the
grid}\label{residential-case-1-small-pv-system-this-doesnt-generate-any-injection-into-the-grid}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{PVRes}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mf}{1.0}
        \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{R}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{1.2}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_3_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_4_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{energy-balance-for-case-residential-1}{%
\subsubsection{Energy Balance for case residential
1}\label{energy-balance-for-case-residential-1}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carryover real\_surplus
1 545.7 203.88  | 4.06 4.06 341.82  | 203.88 4.06 99.9 4.06  | 0.0 0.0
2 544.95 126.82  | 0.0 0.0 418.13  | 330.7 4.06 157.98 0.0  | 0.0 0.0
3 548.07 153.22  | 0.0 0.0 394.85  | 483.93 4.06 233.06 0.0  | 0.0 0.0
4 541.16 173.87  | 0.0 0.0 367.29  | 657.8 4.06 318.26 0.0  | 0.0 0.0
5 554.52 174.29  | 0.0 0.0 380.23  | 832.08 4.07 403.66 0.0  | 0.0 0.0
6 557.49 159.43  | 0.0 0.0 398.06  | 991.52 4.07 481.78 0.0  | 0.0 0.0
7 539.99 157.44  | 0.43 0.43 382.55  | 1148.95 4.49 558.92 0.43  | 0.0 0.0
8 546.45 179.83  | 0.25 0.25 366.62  | 1328.78 4.74 646.61 0.25  | 0.0 0.0
9 538.42 184.34  | 0.29 0.29 354.08  | 1513.12 5.03 736.69 0.29  | 0.0 0.0
10 557.35 165.63  | 0.0 0.0 391.72  | 1678.76 5.03 817.56 0.0  | 0.0 0.0
11 558.21 159.63  | 0.0 0.0 398.58  | 1838.39 5.03 895.78 0.0  | 0.0 0.0
12 559.28 171.98  | 0.0 0.0 387.3  | 2010.36 5.03 980.05 0.0  | 0.0 0.0

    \end{Verbatim}

    \hypertarget{billings-case-residential-1}{%
\subsubsection{Billings case residential
1}\label{billings-case-residential-1}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{bills\PYZus{}residential} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
        \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
            \PY{n}{bills\PYZus{}residential}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{residential}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
        \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost | counterfactual\_cost savings
116914.99 85.44 117000.44  | 140161.69 23161.25
125615.81 0.0 125615.81  | 140076.03 14460.22
122961.24 0.0 122961.24  | 140431.93 17470.69
119819.55 0.0 119819.55  | 139643.87 19824.32
121295.25 0.06 121295.31  | 141167.58 19872.27
123327.29 0.0 123327.29  | 141505.74 18178.44
121559.56 8.94 121568.5  | 139510.39 17941.89
119742.46 5.24 119747.7  | 140246.91 20499.21
118312.86 6.1 118318.96  | 139331.3 21012.35
122604.81 0.0 122604.81  | 141490.19 18885.38
123387.01 0.0 123387.01  | 141588.18 18201.16
122101.09 0.0 122101.09  | 141709.88 19608.8

    \end{Verbatim}

    \hypertarget{residential-case-2-medium-size-pv-system-produces-some-injection-into-the-grid}{%
\subsection{Residential Case 2: Medium Size PV System, produces some
injection into the
grid}\label{residential-case-2-medium-size-pv-system-produces-some-injection-into-the-grid}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{PVRes}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mf}{2.0}
        \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
        \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{)}
        \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{energy-balance-for-case-residential-2}{%
\subsubsection{Energy Balance for case residential
2}\label{energy-balance-for-case-residential-2}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carryover real\_surplus
1 545.86 379.04  | 135.11 135.11 166.82  | 379.04 135.11 185.73 135.11  | 0.0 0.0
2 543.86 276.91  | 74.23 74.23 266.95  | 655.95 209.34 186.31 74.23  | 0.0 0.0
3 551.63 302.53  | 84.74 84.74 249.1  | 958.48 294.08 260.32 84.74  | 0.0 0.0
4 544.17 308.05  | 80.44 80.44 236.11  | 1266.53 374.52 326.53 80.44  | 0.0 0.0
5 556.57 362.58  | 108.24 108.24 193.99  | 1629.12 482.76 423.75 108.24  | 0.0 0.0
6 556.66 337.68  | 106.18 106.18 218.98  | 1966.8 588.94 480.97 106.18  | 0.0 0.0
7 541.74 347.89  | 107.26 107.26 193.84  | 2314.69 696.2 545.26 107.26  | 0.0 0.0
8 548.45 332.38  | 99.58 99.58 216.07  | 2647.07 795.78 600.87 99.58  | 0.0 0.0
9 537.53 337.07  | 102.7 102.7 200.46  | 2984.14 898.48 666.45 102.7  | 0.0 0.0
10 558.58 346.67  | 107.29 107.29 211.91  | 3330.81 1005.77 733.62 107.29  | 0.0 0.0
11 561.2 335.22  | 99.94 99.94 225.98  | 3666.03 1105.71 790.58 99.94  | 0.0 0.0
12 557.38 319.96  | 83.17 83.17 237.42  | 3985.98 1188.88 847.42 83.17  | 0.0 0.0

    \end{Verbatim}

    \hypertarget{billings-case-residential-2}{%
\subsubsection{Billings case residential
2}\label{billings-case-residential-2}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{bills\PYZus{}residential} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}residential}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{residential}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost | counterfactual\_cost savings
74516.11 2841.34 77357.45  | 140180.29 62822.83
86441.35 1561.06 88002.41  | 139951.52 51949.11
84473.14 1782.0 86255.15  | 140838.08 54582.93
83040.35 1691.72 84732.08  | 139986.88 55254.8
76469.07 2276.27 78745.34  | 141401.36 62656.02
81150.75 2233.01 83383.76  | 141411.93 58028.17
76458.39 2255.64 78714.03  | 139709.75 60995.72
80829.19 2094.14 82923.33  | 140475.3 57551.96
79057.0 2159.82 81216.82  | 139230.11 58013.28
80370.45 2256.33 82626.77  | 141629.78 59003.0
81923.12 2101.68 84024.81  | 141929.42 57904.62
83184.86 1749.03 84933.89  | 141493.45 56559.56

    \end{Verbatim}

    \hypertarget{residential-case-3-large-pv-system-that-generates-multi-day-carry-over}{%
\subsection{Residential Case 3: Large PV System that generates multi-day
carry
over}\label{residential-case-3-large-pv-system-that-generates-multi-day-carry-over}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{PVRes}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mf}{4.0}
         \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{energy-balance-for-case-residential-3}{%
\subsubsection{Energy Balance for case residential
3}\label{energy-balance-for-case-residential-3}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{residential}\PY{p}{,} \PY{n}{PVRes}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carryover real\_surplus
1 545.93 793.76  | 531.39 283.56 0.0  | 793.76 283.56 388.94 388.94  | 105.38 247.83
2 542.57 546.89  | 303.76 299.43 0.0  | 1340.65 582.99 373.36 373.36  | 73.93 109.71
3 552.18 575.34  | 346.48 323.33 0.0  | 1915.99 906.32 355.84 355.84  | 32.51 97.08
4 541.28 653.03  | 398.96 287.22 0.0  | 2569.01 1193.54 352.5 352.5  | 65.28 144.26
5 555.65 723.17  | 451.58 284.07 0.0  | 3292.18 1477.6 419.63 419.63  | 135.57 232.8
6 557.81 662.34  | 399.18 294.66 0.0  | 3954.52 1772.26 460.11 460.11  | 165.45 240.09
7 539.31 695.53  | 432.2 275.98 0.0  | 4650.05 2048.24 506.26 506.26  | 230.28 321.67
8 546.77 727.52  | 463.36 282.61 0.0  | 5377.57 2330.85 586.76 586.76  | 304.16 411.03
9 538.01 660.31  | 412.11 289.82 0.0  | 6037.88 2620.67 627.71 627.71  | 337.89 426.46
10 558.31 701.52  | 436.3 293.1 0.0  | 6739.39 2913.76 681.63 681.63  | 388.54 481.1
11 555.9 688.69  | 427.66 294.88 0.0  | 7428.08 3208.64 725.99 725.99  | 431.12 521.32
12 559.38 698.32  | 433.46 294.52 0.0  | 8126.4 3503.16 773.29 773.29  | 478.78 570.06

    \end{Verbatim}

    \hypertarget{billings-case-residential-3}{%
\subsubsection{Billings case residential
3}\label{billings-case-residential-3}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{bills\PYZus{}residential} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}residential}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{residential}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost | counterfactual\_cost savings
0.0 5963.28 5963.28  | 140187.45 134224.17
0.0 6297.01 6297.01  | 139804.51 133507.49
0.0 6799.62 6799.62  | 140900.81 134101.19
0.0 6040.18 6040.18  | 139657.74 133617.56
0.0 5973.91 5973.91  | 141296.18 135322.27
0.0 6196.62 6196.62  | 141542.3 135345.68
0.0 5803.93 5803.93  | 139433.53 133629.6
0.0 5943.2 5943.2  | 140283.28 134340.08
0.0 6094.88 6094.88  | 139285.22 133190.34
0.0 6163.82 6163.82  | 141599.79 135435.96
0.0 6201.26 6201.26  | 141325.06 135123.8
0.0 6193.71 6193.71  | 141721.03 135527.32

    \end{Verbatim}

    \hypertarget{commercial-consumer-subject-to-commercial-and-small-size-industrial-tariff-cases}{%
\section{Commercial consumer subject to commercial and small size
industrial tariff
cases}\label{commercial-consumer-subject-to-commercial-and-small-size-industrial-tariff-cases}}

    \hypertarget{commercial-case1-small-pv-system}{%
\subsection{Commercial case1: small PV
system}\label{commercial-case1-small-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{o}\PY{l+s}{m}\PY{l+s}{m}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{c}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{mean}\PY{p}{(}\PY{n}{commercial}\PY{o}{.}\PY{n}{peak\PYZus{}power}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} 13.847359136480511
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_31_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | peak\_power peak\_demand  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 4985.84 1918.29  | 0.0 0.0 3067.55  | 14.75 10.11  | 1918.29 0.0 939.96 0.0  | 0.0 0.0
2 5082.92 1396.45  | 0.0 0.0 3686.47  | 16.86 12.59  | 3314.74 0.0 1624.22 0.0  | 0.0 0.0
3 4857.45 1400.8  | 0.0 0.0 3456.65  | 14.37 10.81  | 4715.54 0.0 2310.62 0.0  | 0.0 0.0
4 5040.28 1710.98  | 0.0 0.0 3329.3  | 15.44 10.22  | 6426.52 0.0 3149.0 0.0  | 0.0 0.0
5 5351.42 1796.71  | 0.0 0.0 3554.71  | 15.93 10.72  | 8223.23 0.0 4029.38 0.0  | 0.0 0.0
6 5205.11 1610.55  | 0.0 0.0 3594.57  | 16.02 10.77  | 9833.78 0.0 4818.55 0.0  | 0.0 0.0
7 4957.85 1700.48  | 0.0 0.0 3257.37  | 14.84 10.64  | 11534.26 0.0 5651.79 0.0  | 0.0 0.0
8 5000.15 1712.05  | 0.0 0.0 3288.1  | 14.96 9.72  | 13246.32 0.0 6490.69 0.0  | 0.0 0.0
9 4925.76 1813.36  | 0.0 0.0 3112.4  | 15.18 10.47  | 15059.68 0.0 7379.24 0.0  | 0.0 0.0
10 4739.8 1882.2  | 0.46 0.46 2857.6  | 14.18 8.82  | 16941.87 0.46 8301.52 0.46  | 0.0 0.0
11 4974.79 1596.79  | 0.0 0.0 3378.01  | 15.19 10.52  | 18538.66 0.46 9083.48 0.0  | 0.0 0.0
12 4824.52 1697.74  | 0.0 0.0 3126.77  | 14.4 10.48  | 20236.4 0.46 9915.37 0.0  | 0.0 0.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{bills\PYZus{}commercial} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{h}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}commercial}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{commercial}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost total\_demand\_charges | counterfactual\_cost counterfactual\_demand\_cost  | savings\_energysavings\_demand
224298.9 0.0 224298.9 115763.85  | 364564.26 168817.52  | 140265.36 53053.66
269554.55 0.0 269554.55 144142.47  | 371663.03 192978.46  | 102108.49 48835.99
252750.2 0.0 252750.2 123764.26  | 355176.86 164520.86  | 102426.66 40756.59
243438.25 0.0 243438.25 116982.74  | 368544.98 176740.65  | 125106.73 59757.91
259920.51 0.0 259920.51 122673.77  | 391296.17 182329.04  | 131375.66 59655.28
262834.61 0.0 262834.61 123230.22  | 380597.8 183321.91  | 117763.19 60091.68
238178.94 0.0 238178.94 121804.64  | 362518.16 169817.54  | 124339.22 48012.9
240425.54 0.0 240425.54 111209.46  | 365610.83 171245.14  | 125185.29 60035.68
227578.55 0.0 227578.55 119805.64  | 360171.71 173770.22  | 132593.16 53964.58
347084.52 9.73 347094.25 0.0  | 346574.07 162299.05  | -520.19 162299.05
246999.87 0.0 246999.87 120422.34  | 363756.83 173848.52  | 116756.96 53426.18
228629.75 0.0 228629.75 119937.33  | 352768.7 164812.28  | 124138.95 44874.95

    \end{Verbatim}

    \hypertarget{commercial-case-2-medium-pv-system}{%
\subsection{Commercial case 2: medium PV
system}\label{commercial-case-2-medium-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{PVComInd}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mf}{18.0}
         \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | peak\_power peak\_demand  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 4982.55 3553.96  | 458.97 458.97 1428.59  | 14.81 6.76  | 3553.96 458.97 1741.44 458.97  | 0.0 0.0
2 5104.64 2454.26  | 49.92 49.92 2650.37  | 16.82 12.56  | 6008.22 508.89 2485.05 49.92  | 0.0 0.0
3 4845.6 2623.19  | 177.8 177.8 2222.42  | 14.26 10.84  | 8631.4 686.69 3720.49 177.8  | 0.0 0.0
4 5021.16 3028.78  | 204.67 204.67 1992.38  | 15.4 10.1  | 11660.18 891.37 5026.79 204.67  | 0.0 0.0
5 5354.65 3043.45  | 117.31 117.31 2311.2  | 15.93 10.38  | 14703.63 1008.68 6313.41 117.31  | 0.0 0.0
6 5213.3 2745.79  | 44.94 44.94 2467.51  | 16.04 10.29  | 17449.42 1053.62 7541.54 44.94  | 0.0 0.0
7 4965.9 2924.29  | 106.49 106.49 2041.61  | 14.79 7.25  | 20373.71 1160.12 8929.49 106.49  | 0.0 0.0
8 4972.08 3074.39  | 207.58 207.58 1897.69  | 14.93 10.18  | 23448.1 1367.69 10329.45 207.58  | 0.0 0.0
9 4922.8 3179.84  | 221.71 221.71 1742.96  | 15.05 8.19  | 26627.95 1589.4 11680.0 221.71  | 0.0 0.0
10 4751.68 2988.32  | 169.36 169.36 1763.36  | 14.13 7.66  | 29616.26 1758.76 12922.57 169.36  | 0.0 0.0
11 4945.29 2811.19  | 151.68 151.68 2134.1  | 15.15 8.29  | 32427.45 1910.44 14130.69 151.68  | 0.0 0.0
12 4842.91 3130.01  | 350.47 350.47 1712.9  | 14.42 9.97  | 35557.47 2260.92 15512.72 350.47  | 0.0 0.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{bills\PYZus{}commercial} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{h}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}commercial}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{commercial}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost total\_demand\_charges | counterfactual\_cost counterfactual\_demand\_cost  | savings\_energy savings\_demand
173516.67 9652.17 183168.83 0.0  | 364323.81 169505.38  | 181154.98 169505.38
321914.51 1049.87 322964.37 0.0  | 373250.92 192505.85  | 50286.54 192505.85
269934.55 3739.15 273673.7 0.0  | 354310.46 163181.67  | 80636.76 163181.67
241994.28 4304.29 246298.56 0.0  | 367146.87 176323.48  | 120848.31 176323.48
280718.16 2467.07 283185.23 0.0  | 391531.99 182384.47  | 108346.76 182384.47
299703.99 945.18 300649.17 0.0  | 381196.49 183619.64  | 80547.32 183619.64
247973.83 2239.52 250213.34 0.0  | 363106.5 169253.98  | 112893.15 169253.98
230492.89 4365.37 234858.26 0.0  | 363558.5 170861.74  | 128700.24 170861.74
211700.1 4662.52 216362.62 0.0  | 359955.38 172304.79  | 143592.76 172304.79
214178.02 3561.64 217739.66 0.0  | 347442.76 161771.88  | 129703.1 161771.88
259208.23 3189.83 262398.06 0.0  | 361599.92 173397.49  | 99201.86 173397.49
208048.81 7370.45 215419.27 0.0  | 354113.88 165058.38  | 138694.61 165058.38

    \end{Verbatim}

    \hypertarget{commercial-case-3-large-pv-system}{%
\subsection{Commercial case 3: Large PV
system}\label{commercial-case-3-large-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{PVComInd}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mf}{28.0}
         \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{commercial}\PY{p}{,} \PY{n}{PVComInd}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month consumer\_energy PV\_energy  | inyection\_grid withdrawn\_energy grid\_energy  | peak\_power peak\_demand  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 4986.26 5124.49  | 1612.66 1474.44 0.0  | 14.9 3.85  | 5124.49 1474.44 2511.0 1612.66  | 138.22 138.22
2 5117.16 3380.87  | 549.5 687.73 1598.06  | 16.8 12.61  | 8505.36 2162.16 2693.19 687.73  | 0.0 0.0
3 4861.92 4301.73  | 1280.39 1278.28 562.29  | 14.36 10.86  | 12807.09 3440.45 4113.31 1280.39  | 2.1 2.1
4 5015.63 4504.92  | 1367.3 1362.05 515.96  | 15.41 9.33  | 17312.01 4802.5 5042.44 1369.4  | 7.36 7.36
5 5342.12 5105.63  | 1652.21 1641.14 247.56  | 15.84 7.44  | 22417.65 6443.64 6182.15 1659.57  | 18.43 18.43
6 5191.58 4267.71  | 1024.36 1042.79 905.44  | 15.86 8.76  | 26685.36 7486.42 6632.19 1042.79  | 0.0 0.0
7 4963.47 4685.48  | 1443.84 1432.09 289.74  | 14.82 9.32  | 31370.85 8918.51 7885.29 1443.84  | 11.75 11.75
8 5010.65 4944.85  | 1753.76 1746.52 73.03  | 14.88 10.47  | 36315.69 10665.03 8876.18 1765.51  | 18.98 18.98
9 4930.17 4840.81  | 1764.3 1762.77 90.9  | 15.19 10.12  | 41156.5 12427.81 9501.65 1783.29  | 20.52 20.52
10 4751.75 4774.55  | 1670.01 1647.2 0.0  | 14.15 5.42  | 45931.05 14075.01 10078.41 1690.52  | 43.32 43.32
11 4951.97 4630.93  | 1460.59 1492.54 289.1  | 15.17 8.85  | 50561.99 15567.54 10700.37 1503.91  | 11.38 11.38
12 4822.71 4982.88  | 1796.39 1636.22 0.0  | 14.38 7.95  | 55544.87 17203.76 11649.44 1807.76  | 171.55 171.55

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{bills\PYZus{}commercial} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{h}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{e}\PY{l+s}{s}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}commercial}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{commercial}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_cost withdrawn\_energy\_cost total\_energy\_cost total\_demand\_charges | counterfactual\_cost counterfactual\_demand\_cost  | savings\_energysavings\_demand
0.0 31007.43 31007.43 0.0  | 364595.66 170576.5  | 333588.23 170576.5
194100.72 14462.87 208563.59 0.0  | 374166.63 192333.05  | 165603.05 192333.05
68295.72 26882.31 95178.03 0.0  | 355503.59 164362.34  | 260325.56 164362.34
62668.51 28643.87 91312.38 0.0  | 366742.64 176381.45  | 275430.26 176381.45
30068.5 34513.23 64581.73 0.0  | 390616.12 181296.57  | 326034.39 181296.57
109975.34 21929.79 131905.13 0.0  | 379608.63 181574.18  | 247703.49 181574.18
35191.59 30116.78 65308.36 0.0  | 362929.21 169682.65  | 297620.84 169682.65
8870.61 36729.39 45600.0 0.0  | 366378.38 170279.49  | 320778.38 170279.49
11040.43 37071.06 48111.5 0.0  | 360494.36 173851.09  | 312382.86 173851.09
0.0 34640.66 34640.66 0.0  | 347447.87 161976.68  | 312807.21 161976.68
35113.49 31388.04 66501.52 0.0  | 362088.04 173582.59  | 295586.51 173582.59
0.0 34409.65 34409.65 0.0  | 352636.72 164603.96  | 318227.07 164603.96

    \end{Verbatim}

    \hypertarget{medium-voltage-tmt-cases-users-are-medium-to-large-industrial-consumers.}{%
\section{Medium Voltage (TMT) cases, users are medium to large
industrial
consumers.}\label{medium-voltage-tmt-cases-users-are-medium-to-large-industrial-consumers.}}

    \hypertarget{tmt-case-1-small-pv-system}{%
\subsection{TMT case 1: small PV
system}\label{tmt-case-1-small-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{I}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{u}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{52}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_48_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_50_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month | consumer\_energy\_peak consumer\_energy\_valley consumer\_energy\_night  | PV\_energy inyection\_grid withdrawn\_energy  | grid\_energy\_peak grid\_energy\_valley grid\_energy\_night  | peak\_power\_peak peak\_power\_valley peak\_power\_night  | peak\_demand\_peak peak\_demand\_valley peak\_demand\_night  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 | 7171.53 8061.68 8061.68  | 5454.08 0.0 0.0  | 4988.14 4790.98 5741.24  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 5454.08 0.0 2672.5 0.0  | 0.0 0.0
2 | 6612.74 7422.19 7422.19  | 3901.21 0.0 0.0  | 4818.17 5315.54 5274.57  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 9355.3 0.0 4584.1 0.0  | 0.0 0.0
3 | 7244.77 8116.67 8116.67  | 4525.47 0.0 0.0  | 5234.24 5601.73 5713.62  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 13880.76 0.0 6801.57 0.0  | 0.0 0.0
4 | 7472.76 8361.64 8361.64  | 5031.16 0.0 0.0  | 5302.08 5501.16 5919.51  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 18911.92 0.0 9266.84 0.0  | 0.0 0.0
5 | 7214.25 8144.07 8144.07  | 5299.47 0.0 0.0  | 4947.79 5111.06 5692.86  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 24211.4 0.0 11863.59 0.0  | 0.0 0.0
6 | 7016.42 7904.32 7904.32  | 5129.02 0.0 0.0  | 4847.8 4943.92 5566.4  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 29340.42 0.0 14376.81 0.0  | 0.0 0.0
7 | 6992.31 7884.51 7884.51  | 4955.88 0.0 0.0  | 4822.65 5098.28 5549.91  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 34296.3 0.0 16805.19 0.0  | 0.0 0.0
8 | 6911.9 7861.43 7861.43  | 5436.77 0.3 0.3  | 4453.84 4882.72 5520.68  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 39733.07 0.3 19469.2 0.3  | 0.0 0.0
9 | 6686.73 7541.77 7541.77  | 4889.06 0.0 0.0  | 4476.96 4862.48 5305.25  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 44622.12 0.3 21864.54 0.0  | 0.0 0.0
10 | 7198.42 8039.35 8039.35  | 5257.78 0.0 0.0  | 5000.04 4979.95 5649.74  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 49879.9 0.3 24440.85 0.0  | 0.0 0.0
11 | 7098.35 7919.32 7919.32  | 4855.23 0.0 0.0  | 5114.5 5047.94 5627.16  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 54735.12 0.3 26819.92 0.0  | 0.0 0.0
12 | 6794.51 7680.47 7680.47  | 5191.56 0.0 0.0  | 4665.27 4618.15 5431.1  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 59926.68 0.3 29363.78 0.0  | 0.0 0.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{bills\PYZus{}TMT}\PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}       
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}  
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}TMT}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_energy\_cost\_peak grid\_energy\_cost\_valley grid\_energy\_cost\_night  | withdrawn\_energy\_cost  | grid\_demand\_cost\_peak grid\_demand\_cost\_valley grid\_demand\_cost\_night  | counterfactual\_energy\_cost\_peak counterfactual\_energy\_cost\_valley counterfactual\_energy\_cost\_night  | savings\_energy\_cost\_peak savings\_energy\_cost\_valley savings\_energy\_cost\_night  | savings\_demand\_cost\_peak savings\_demand\_cost\_valley savings\_demand\_cost\_night 
309065.41 148472.38 128087.03  | 0.0  | 309065.41 148472.38 128087.03  | 444347.85 249831.41 179856.04  | 135282.44 101359.03 51769.02  | 0.0 0.0 0.0 
298534.08 164728.57 117675.77  | 0.0  | 298534.08 164728.57 117675.77  | 409725.26 230013.66 165589.05  | 111191.18 65285.09 47913.28  | 0.0 0.0 0.0 
324313.43 173597.71 127470.88  | 0.0  | 324313.43 173597.71 127470.88  | 448885.83 251535.59 181082.9  | 124572.4 77937.88 53612.02  | 0.0 0.0 0.0 
328516.82 170480.8 132064.19  | 0.0  | 328516.82 170480.8 132064.19  | 463011.97 259127.17 186548.15  | 134495.15 88646.37 54483.96  | 0.0 0.0 0.0 
306565.09 158391.82 127007.69  | 0.0  | 306565.09 158391.82 127007.69  | 446995.13 252384.87 181694.3  | 140430.04 93993.04 54686.61  | 0.0 0.0 0.0 
300369.7 153212.06 124186.31  | 0.0  | 300369.7 153212.06 124186.31  | 434737.29 244954.92 176345.41  | 134367.58 91742.86 52159.1  | 0.0 0.0 0.0 
298811.22 157995.82 123818.46  | 0.0  | 298811.22 157995.82 123818.46  | 433243.28 244340.81 175903.31  | 134432.06 86344.99 52084.85  | 0.0 0.0 0.0 
275960.21 151315.51 123166.34  | 6.23  | 275960.21 151315.51 123166.34  | 428261.46 243625.68 175388.48  | 152301.26 92310.17 52222.14  | 0.0 0.0 0.0 
277392.21 150688.32 118360.09  | 0.0  | 277392.21 150688.32 118360.09  | 414309.67 233719.34 168256.81  | 136917.45 83031.02 49896.72  | 0.0 0.0 0.0 
309802.59 154328.6 126045.74  | 0.0  | 309802.59 154328.6 126045.74  | 446013.79 249139.49 179357.92  | 136211.21 94810.89 53312.18  | 0.0 0.0 0.0 
316894.7 156435.61 125542.05  | 0.0  | 316894.7 156435.61 125542.05  | 439813.5 245419.84 176680.11  | 122918.8 88984.23 51138.06  | 0.0 0.0 0.0 
289059.87 143116.58 121167.77  | 0.0  | 289059.87 143116.58 121167.77  | 420987.76 238017.67 171351.21  | 131927.89 94901.09 50183.45  | 0.0 0.0 0.0 

    \end{Verbatim}

    \hypertarget{tmt-case2-medium-pv-system}{%
\subsection{TMT Case2: Medium PV
System}\label{tmt-case2-medium-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{PVTMT}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_55_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month | consumer\_energy\_peak consumer\_energy\_valley consumer\_energy\_night  | PV\_energy inyection\_grid withdrawn\_energy  | grid\_energy\_peak grid\_energy\_valley grid\_energy\_night  | peak\_power\_peak peak\_power\_valley peak\_power\_night  | peak\_demand\_peak peak\_demand\_valley peak\_demand\_night  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 | 7222.49 8115.01 8115.01  | 11213.88 1541.17 1541.17  | 1449.58 2674.05 5720.16  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 11213.88 1541.17 5494.8 1541.17  | 0.0 0.0
2 | 6620.78 7442.15 7442.15  | 8267.14 704.3 704.3  | 3316.33 2479.45 5255.56  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 19481.02 2245.47 8004.53 704.3  | 0.0 0.0
3 | 7235.67 8152.62 8152.62  | 9742.98 526.8 526.8  | 3401.4 2243.91 5732.27  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 29224.0 2772.26 12074.29 526.8  | 0.0 0.0
4 | 7467.57 8429.27 8429.27  | 10512.92 1159.84 1159.84  | 2804.41 2579.51 5933.88  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 39736.92 3932.1 16698.83 1159.84  | 0.0 0.0
5 | 7184.59 8063.22 8063.22  | 10286.6 1230.19 1230.19  | 2994.36 1966.85 5742.92  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 50023.51 5162.29 20579.42 1230.19  | 0.0 0.0
6 | 6973.31 7857.23 7857.23  | 9914.84 1001.54 1001.54  | 2685.34 2230.36 5589.8  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 59938.35 6163.83 24207.5 1001.54  | 0.0 0.0
7 | 7019.6 7811.98 7811.98  | 10466.67 1462.48 1462.48  | 2225.69 2139.23 5534.07  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 70405.02 7626.31 28334.62 1462.48  | 0.0 0.0
8 | 6943.48 7829.18 7829.18  | 10801.31 1780.69 1780.69  | 1750.22 2221.14 5537.96  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 81206.33 9407.0 32164.79 1780.69  | 0.0 0.0
9 | 6579.9 7476.94 7476.94  | 10195.0 1446.14 1446.14  | 1855.51 2006.32 5273.92  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 91401.33 10853.14 35379.65 1446.14  | 0.0 0.0
10 | 7137.75 8038.41 8038.41  | 10607.26 1123.54 1123.54  | 2446.15 2122.76 5675.24  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 102008.59 11976.68 39131.07 1123.54  | 0.0 0.0
11 | 7098.5 7946.65 7946.65  | 9732.1 1206.08 1206.08  | 2762.04 2551.01 5613.65  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 111740.69 13182.76 42776.26 1206.08  | 0.0 0.0
12 | 6887.76 7689.57 7689.57  | 9925.95 991.85 991.85  | 2563.8 2087.57 5446.53  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 121666.64 14174.61 46433.89 991.85  | 0.0 0.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{bills\PYZus{}TMT}\PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}       
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}  
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}TMT}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_energy\_cost\_peak grid\_energy\_cost\_valley grid\_energy\_cost\_night  | withdrawn\_energy\_cost  | grid\_demand\_cost\_peak grid\_demand\_cost\_valley grid\_demand\_cost\_night  | counterfactual\_energy\_cost\_peak counterfactual\_energy\_cost\_valley counterfactual\_energy\_cost\_night  | savings\_energy\_cost\_peak savings\_energy\_cost\_valley savings\_energy\_cost\_night  | savings\_demand\_cost\_peak savings\_demand\_cost\_valley savings\_demand\_cost\_night 
89815.72 82868.82 127616.79  | 32410.73  | 89815.72 82868.82 127616.79  | 447505.71 251484.1 181045.83  | 357689.99 168615.28 53429.04  | 0.0 0.0 0.0 
205480.1 76838.11 117251.5  | 14811.45  | 205480.1 76838.11 117251.5  | 410223.45 230632.19 166034.34  | 204743.34 153794.08 48782.83  | 0.0 0.0 0.0 
210750.68 69538.83 127886.84  | 11078.51  | 210750.68 69538.83 127886.84  | 448322.31 252649.54 181884.84  | 237571.63 183110.71 53998.0  | 0.0 0.0 0.0 
173761.4 79938.96 132384.84  | 24391.47  | 173761.4 79938.96 132384.84  | 462690.78 261223.02 188056.97  | 288929.38 181284.06 55672.13  | 0.0 0.0 0.0 
185530.35 60952.8 128124.52  | 25870.82  | 185530.35 60952.8 128124.52  | 445157.11 249879.09 179890.37  | 259626.77 188926.3 51765.85  | 0.0 0.0 0.0 
166383.45 69118.73 124708.52  | 21062.45  | 166383.45 69118.73 124708.52  | 432066.0 243495.47 175294.74  | 265682.55 174376.74 50586.21  | 0.0 0.0 0.0 
137903.71 66294.59 123465.04  | 30755.94  | 137903.71 66294.59 123465.04  | 434934.35 242093.3 174285.3  | 297030.64 175798.71 50820.27  | 0.0 0.0 0.0 
108443.69 68833.0 123551.92  | 37447.83  | 108443.69 68833.0 123551.92  | 430218.12 242626.38 174669.07  | 321774.43 173793.38 51117.15  | 0.0 0.0 0.0 
114967.54 62175.93 117661.15  | 30412.38  | 114967.54 62175.93 117661.15  | 407690.49 231710.41 166810.56  | 292722.95 169534.48 49149.41  | 0.0 0.0 0.0 
151563.34 65784.18 126614.71  | 23627.96  | 151563.34 65784.18 126614.71  | 442254.99 249110.34 179336.94  | 290691.65 183326.16 52722.23  | 0.0 0.0 0.0 
171135.92 79055.86 125240.58  | 25363.93  | 171135.92 79055.86 125240.58  | 439823.1 246266.75 177289.81  | 268687.18 167210.89 52049.23  | 0.0 0.0 0.0 
158853.18 64693.88 121511.99  | 20858.61  | 158853.18 64693.88 121511.99  | 426765.34 238299.7 171554.25  | 267912.16 173605.82 50042.26  | 0.0 0.0 0.0 

    \end{Verbatim}

    \hypertarget{tmt-case-3-large-pv-system}{%
\subsection{TMT Case 3: Large PV
System}\label{tmt-case-3-large-pv-system}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{PVTMT}\PY{o}{.}\PY{n}{capacity} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{ts}\PY{o}{=}\PY{n}{simulate}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_61_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{hours} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{72}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{N}\PY{l+s}{e}\PY{l+s}{t}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{j}\PY{l+s}{e}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{i}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{ }\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{o}\PY{l+s}{ }\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{e}\PY{l+s}{ }\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{p}\PY{l+s}{v}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{V}\PY{l+s}{ }\PY{l+s}{C}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{y}\PY{l+s}{e}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{h}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{C}\PY{l+s}{a}\PY{l+s}{r}\PY{l+s}{r}\PY{l+s}{y}\PY{l+s}{o}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{W}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{l}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plot}\PY{p}{(}\PY{n}{hours}\PY{p}{,} \PY{n}{ts}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{v}\PY{l+s}{e}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{T}\PY{l+s}{o}\PY{l+s}{t}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{ }\PY{l+s}{D}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{e}\PY{l+s}{d}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{H}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{P}\PY{l+s}{o}\PY{l+s}{w}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{ }\PY{l+s}{[}\PY{l+s}{k}\PY{l+s}{W}\PY{l+s}{]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{grid}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{ebalance} \PY{o}{=} \PY{n}{annual\PYZus{}energy\PYZus{}balance}\PY{p}{(}\PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{PVTMT}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
month | consumer\_energy\_peak consumer\_energy\_valley consumer\_energy\_night  | PV\_energy inyection\_grid withdrawn\_energy  | grid\_energy\_peak grid\_energy\_valley grid\_energy\_night  | peak\_power\_peak peak\_power\_valley peak\_power\_night  | peak\_demand\_peak peak\_demand\_valley peak\_demand\_night  | global\_generation global\_withdrawl global\_allowance max\_surplus  | carry\_over real\_surplus
1 | 7215.5 8079.83 8079.83  | 19804.83 8613.91 8613.91  | 0.0 1227.31 0.0  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 19804.83 8613.91 9704.37 8613.91  | 0.0 0.0
2 | 6606.74 7472.23 7472.23  | 12856.92 3864.05 3864.05  | 16.56 1470.73 4978.27  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 32661.75 12477.96 7390.34 3864.05  | 0.0 0.0
3 | 7147.17 8109.81 8109.81  | 15942.57 5806.35 5806.35  | 0.0 1147.84 3876.56  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 48604.31 18284.31 11338.15 5806.35  | 0.0 0.0
4 | 7448.85 8412.33 8412.33  | 16683.52 5901.71 5901.71  | 0.0 1878.41 3181.88  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 65287.84 24186.02 13706.73 5901.71  | 0.0 0.0
5 | 7148.88 8099.94 8099.94  | 17400.8 7159.82 7159.82  | 0.0 1755.58 1799.41  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 82688.63 31345.84 16331.41 7159.82  | 0.0 0.0
6 | 7044.43 7914.74 7914.74  | 16935.62 6447.29 6447.29  | 0.0 1548.5 2080.11  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 99624.26 37793.13 17470.04 6447.29  | 0.0 0.0
7 | 7007.7 7829.22 7829.22  | 18568.61 7783.9 7783.9  | 0.0 1018.14 756.73  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 118192.87 45577.03 20121.37 7783.9  | 0.0 0.0
8 | 6930.04 7771.18 7771.18  | 16420.23 6656.57 6656.57  | 0.0 1719.31 2085.25  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 134613.1 52233.6 20383.39 6656.57  | 0.0 0.0
9 | 6677.78 7450.35 7450.35  | 16575.21 6825.19 6825.19  | 0.0 1483.54 1366.83  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 151188.3 59058.79 21848.67 6825.19  | 0.0 0.0
10 | 7139.38 8005.59 8005.59  | 17613.43 6909.64 6909.64  | 0.0 1301.61 1892.58  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 168801.73 65968.43 23654.06 6909.64  | 0.0 0.0
11 | 7048.48 7980.75 7980.75  | 15925.53 5189.64 5189.64  | 0.0 1203.49 3507.25  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 184727.26 71158.07 24547.93 5189.64  | 0.0 0.0
12 | 6796.18 7689.76 7689.76  | 16551.42 6266.33 6266.33  | 0.0 1431.97 1958.65  | 0.0 0.0 0.0  | 0.0 0.0 0.0  | 201278.68 77424.4 27468.48 6266.33  | 0.0 0.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{bills\PYZus{}TMT}\PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
         \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{w}\PY{l+s}{i}\PY{l+s}{t}\PY{l+s}{h}\PY{l+s}{d}\PY{l+s}{r}\PY{l+s}{a}\PY{l+s}{w}\PY{l+s}{n}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}       
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}    
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{g}\PY{l+s}{r}\PY{l+s}{i}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,} 
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{u}\PY{l+s}{n}\PY{l+s}{t}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{f}\PY{l+s}{a}\PY{l+s}{c}\PY{l+s}{t}\PY{l+s}{u}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}        
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{e}\PY{l+s}{n}\PY{l+s}{e}\PY{l+s}{r}\PY{l+s}{g}\PY{l+s}{y}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}  
                  \PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{|}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{p}\PY{l+s}{e}\PY{l+s}{a}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{v}\PY{l+s}{a}\PY{l+s}{l}\PY{l+s}{l}\PY{l+s}{e}\PY{l+s}{y}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{,}
                 \PY{l+s}{\PYZdq{}}\PY{l+s}{s}\PY{l+s}{a}\PY{l+s}{v}\PY{l+s}{i}\PY{l+s}{n}\PY{l+s}{g}\PY{l+s}{s}\PY{l+s}{\PYZus{}}\PY{l+s}{d}\PY{l+s}{e}\PY{l+s}{m}\PY{l+s}{a}\PY{l+s}{n}\PY{l+s}{d}\PY{l+s}{\PYZus{}}\PY{l+s}{c}\PY{l+s}{o}\PY{l+s}{s}\PY{l+s}{t}\PY{l+s}{\PYZus{}}\PY{l+s}{n}\PY{l+s}{i}\PY{l+s}{g}\PY{l+s}{h}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{ }\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{m} \PY{k+kp}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{12}
             \PY{n}{bills\PYZus{}TMT}\PY{p}{[}\PY{n}{m}\PY{p}{]} \PY{o}{=} \PY{n}{monthly\PYZus{}bill}\PY{p}{(}\PY{n}{ebalance}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{,} \PY{n}{mediumvoltage}\PY{p}{,} \PY{n}{print\PYZus{}output}\PY{o}{=}\PY{k+kc}{true}\PY{p}{)}
         \PY{k}{end}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
grid\_energy\_cost\_peak grid\_energy\_cost\_valley grid\_energy\_cost\_night  | withdrawn\_energy\_cost  | grid\_demand\_cost\_peak grid\_demand\_cost\_valley grid\_demand\_cost\_night  | counterfactual\_energy\_cost\_peak counterfactual\_energy\_cost\_valley counterfactual\_energy\_cost\_night  | savings\_energy\_cost\_peak savings\_energy\_cost\_valley savings\_energy\_cost\_night  | savings\_demand\_cost\_peak savings\_demand\_cost\_valley savings\_demand\_cost\_night 
0.0 38034.3 0.0  | 181150.63  | 0.0 38034.3 0.0  | 447072.16 250394.08 180261.11  | 447072.16 212359.78 180261.11  | 0.0 0.0 0.0 
1026.13 45577.78 111065.23  | 81260.96  | 1026.13 45577.78 111065.23  | 409353.8 231564.37 166705.42  | 408327.68 185986.59 55640.19  | 0.0 0.0 0.0 
0.0 35571.47 86486.06  | 122107.51  | 0.0 35571.47 86486.06  | 442838.6 251322.92 180929.8  | 442838.6 215751.45 94443.73  | 0.0 0.0 0.0 
0.0 58211.94 70987.69  | 124112.89  | 0.0 58211.94 70987.69  | 461530.94 260697.99 187679.0  | 461530.94 202486.06 116691.31  | 0.0 0.0 0.0 
0.0 54405.38 40144.75  | 150571.04  | 0.0 54405.38 40144.75  | 442944.59 251017.13 180709.65  | 442944.59 196611.75 140564.9  | 0.0 0.0 0.0 
0.0 47988.08 46407.18  | 135586.54  | 0.0 47988.08 46407.18  | 436472.98 245277.73 176577.81  | 436472.98 197289.66 130170.63  | 0.0 0.0 0.0 
0.0 31552.14 16882.61  | 163695.39  | 0.0 31552.14 16882.61  | 434197.14 242627.56 174669.92  | 434197.14 211075.41 157787.31  | 0.0 0.0 0.0 
0.0 53281.35 46521.86  | 139987.64  | 0.0 53281.35 46521.86  | 429385.25 240828.83 173375.0  | 429385.25 187547.49 126853.14  | 0.0 0.0 0.0 
0.0 45974.99 30494.0  | 143533.73  | 0.0 45974.99 30494.0  | 413755.31 230886.5 166217.42  | 413755.31 184911.5 135723.41  | 0.0 0.0 0.0 
0.0 40337.05 42223.56  | 145309.67  | 0.0 40337.05 42223.56  | 442356.24 248093.26 178604.73  | 442356.24 207756.21 136381.17  | 0.0 0.0 0.0 
0.0 37296.05 78246.76  | 109138.17  | 0.0 37296.05 78246.76  | 436724.11 247323.37 178050.48  | 436724.11 210027.32 99803.72  | 0.0 0.0 0.0 
0.0 44376.71 43697.39  | 131780.87  | 0.0 44376.71 43697.39  | 421091.49 238305.71 171558.58  | 421091.49 193929.01 127861.2  | 0.0 0.0 0.0 

    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
